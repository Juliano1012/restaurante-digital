
/* =========================
   Design System (RNF 0010) + Compatibilidade (RNF 005)
   ========================= */

/* Tokens - Tema Claro */
:root {
  /* Paleta base (gastronomia: tons terrosos + creme) */
  --bg: #f8f5ef;
  --bg-2: #f3efe6;
  --card: #fffdf8;
  --surface-2: #f7f3eb;
  --text: #2b2620;
  --muted: #6e655a;
  --border: #e8decd;

  /* Marca / Acentos */
  --primary: #b86b45;
  --primary-600: #a75f3d;
  --primary-700: #8f5033;
  --accent: #d9c7ab;
  --accent-2: #c9b396;
  --success: #2e7d32;
  --danger: #c62828;

  /* Cores ETA (REQ 006) */
  --eta-ok: #2e7d32;
  --eta-warn: #c62828;
  --eta-bar: #e2d5bf;
  --eta-bar-fill: #8a735d;

  /* Mesa */
  --table-error: #d9534f;

  /* Tipografia */
  --font-sans: "Segoe UI", system-ui, -apple-system, "Helvetica Neue", Arial, sans-serif;
  --fs-1: clamp(26px, 4.5vw, 34px);
  --fs-2: clamp(20px, 3.5vw, 24px);
  --fs-3: clamp(16px, 3vw, 18px);
  --fs-4: 16px; /* >=16px para evitar zoom em iOS */
  --fs-5: 12px;

  /* Espaçamento */
  --space-1: 6px;
  --space-2: 10px;
  --space-3: 14px;
  --space-4: 18px;
  --space-5: 24px;

  /* Raio e elevação */
  --radius-8: 8px;
  --radius-10: 10px;
  --radius-12: 12px;
  --radius-14: 14px;
  --radius-pill: 999px;

  --shadow-1: 0 1px 2px rgba(0,0,0,.04), 0 2px 10px rgba(0,0,0,.04);
  --shadow-2: 0 8px 20px rgba(32, 22, 11, .08);

  /* Foco acessível */
  --focus: 0 0 0 3px rgba(184,107,69,.25);

  /* Transições */
  --transition-fast: .15s ease;
  --transition-slow: .3s ease;

  /* Safe area para dispositivos com notch */
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
}

/* Tokens - Tema Escuro */
:root[data-theme="dark"] {
  --bg: #141210;
  --bg-2: #191714;
  --card: #1f1b18;
  --surface-2: #25201c;
  --text: #f3ebe2;
  --muted: #c9b9a7;
  --border: #3a332c;

  --primary: #d7875f;
  --primary-600: #c67854;
  --primary-700: #b76b4a;
  --accent: #4b4036;
  --accent-2: #3f352d;

  --eta-ok: #7ad87f;
  --eta-warn: #ff6b6b;
  --eta-bar: #3b332b;
  --eta-bar-fill: #d7875f;

  --focus: 0 0 0 3px rgba(215,135,95,.35);
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: var(--font-sans);
  background: radial-gradient(1800px 800px at 50% -10%, var(--bg-2), var(--bg));
  color: var(--text);
  line-height: 1.35;
  letter-spacing: .2px;

  /* RNF-005: suaviza a interação no mobile */
  -webkit-text-size-adjust: 100%;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

/* Acessibilidade: foco visível */
:where(button, a, input, textarea) { outline: none; font-size: var(--fs-4); }
:where(button, a, input, textarea):focus-visible {
  box-shadow: var(--focus);
  transition: box-shadow var(--transition-fast);
}

/* ===== Header ===== */
.app-header {
  padding: calc(var(--space-3) + var(--safe-top)) var(--space-5) var(--space-3) var(--space-5);
  border-bottom: 1px solid var(--border);
  display: grid;
  grid-template-columns: 1fr auto auto auto;
  gap: var(--space-3);
  align-items: center;
  backdrop-filter: saturate(120%) blur(6px);
  background:
    linear-gradient(180deg, color-mix(in srgb, var(--card) 70%, transparent) 0%, transparent 100%),
    transparent;
  position: sticky;
  top: 0;
  z-index: 10;
}
.app-header h1 {
  margin: 0;
  font-size: 22px;
  letter-spacing: .5px;
  font-weight: 700;
}

/* Navegação topo */
.top-nav { display: flex; flex-wrap: wrap; gap: var(--space-2); }
.nav-btn {
  min-height: 44px; /* alvo de toque >= 44px */
  background: var(--accent);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 8px 14px;
  border-radius: var(--radius-10);
  cursor: pointer;
  transition: transform var(--transition-fast), background var(--transition-fast), box-shadow var(--transition-fast);
}
.nav-btn:hover { transform: translateY(-1px); box-shadow: var(--shadow-1); }
.nav-btn:active { transform: translateY(0); }

/* Toggle de tema */
.icon-btn {
  min-height: 44px;
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 8px 12px;
  border-radius: var(--radius-10);
  cursor: pointer;
  transition: background var(--transition-fast), transform var(--transition-fast);
}
.icon-btn:hover { transform: translateY(-1px); }

/* Indicador de mesa no header */
.table-status {
  justify-self: end;
  color: var(--text);
  font-weight: 600;
  background: color-mix(in srgb, var(--accent) 70%, white 30%);
  padding: 4px 10px;
  border-radius: var(--radius-pill);
  border: 1px solid var(--border);
}

/* ===== Screens ===== */
.screen {
  display: none;
  padding: var(--space-5) var(--space-5);
  max-width: 1020px;
  margin: 0 auto;
}
.screen.active { display: block; }

/* ===== Home ===== */
.home-title {
  font-size: var(--fs-1);
  text-align: center;
  margin: 8px 0 22px 0;
  letter-spacing: .5px;
}
.home-buttons {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--space-2);
  max-width: 480px;
  margin: 0 auto;
}
.big-btn {
  min-height: 48px;
  background: linear-gradient(180deg, color-mix(in srgb, var(--primary) 30%, white) 0%, var(--primary) 100%);
  border: 1px solid color-mix(in srgb, var(--primary) 60%, black 10%);
  color: white;
  padding: 14px;
  border-radius: var(--radius-12);
  font-size: 18px;
  cursor: pointer;
  box-shadow: var(--shadow-1);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast), filter var(--transition-fast);
}
.big-btn:hover { transform: translateY(-1px); filter: brightness(1.03); box-shadow: var(--shadow-2); }
.big-btn:active { transform: translateY(0); }

/* ===== Category nav ===== */
.category-nav {
  display: flex; flex-wrap: wrap; gap: var(--space-2);
  margin-bottom: var(--space-3);
}
.tab-btn {
  min-height: 40px;
  background: var(--card);
  border: 1px solid var(--border);
  padding: 8px 12px;
  border-radius: var(--radius-10);
  color: var(--text);
  cursor: pointer;
  transition: background var(--transition-fast), transform var(--transition-fast);
}
.tab-btn:hover { transform: translateY(-1px); }
.tab-btn.active {
  background: color-mix(in srgb, var(--primary) 20%, var(--card));
  border-color: color-mix(in srgb, var(--primary) 40%, var(--border));
  color: var(--text);
}

/* ===== Grid list (cards) ===== */
.grid-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: var(--space-3);
}
@media (max-width: 440px) {
  .grid-list { grid-template-columns: 1fr; }
}
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius-14);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  box-shadow: var(--shadow-1);
  transition: transform var(--transition-slow), box-shadow var(--transition-slow);
}
.card:hover { transform: translateY(-2px); box-shadow: var(--shadow-2); }
.card-img {
  width: 100%;
  height: 180px;
  object-fit: cover;
  display: block;
}
.card-info { padding: var(--space-3); }
.card-info h3 { margin: 0 0 6px; font-size: var(--fs-3); }
.price { color: var(--primary-700); font-weight: 700; margin: 0 0 10px; }
.add-btn, .view-btn {
  min-height: 44px;
  background: var(--accent-2);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 8px 12px;
  border-radius: var(--radius-10);
  cursor: pointer;
  margin-right: 8px;
  transition: background var(--transition-fast), transform var(--transition-fast);
}
.add-btn:hover, .view-btn:hover { transform: translateY(-1px); }

/* ===== Detail ===== */
.back-btn {
  min-height: 44px;
  border: 1px solid var(--border);
  background: var(--card);
  color: var(--text);
  padding: 8px 12px;
  border-radius: var(--radius-10);
  cursor: pointer;
  margin-bottom: var(--space-3);
}
.detail {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-4);
  align-items: start;
}
@media (max-width: 760px) {
  .detail { grid-template-columns: 1fr; }
}
.detail-img {
  height: 300px;
  border-radius: var(--radius-12);
  background: var(--surface-2);
  overflow: hidden;
}
.detail-info h2 { margin: 0 0 6px; font-size: var(--fs-2); }
.ingredients h4 { margin: 16px 0 6px; font-size: 14px; letter-spacing: .4px; color: var(--muted); }
.ingredients ul { margin: 0; padding-left: 18px; }
.qty { display: inline-flex; align-items: center; gap: 12px; margin: 16px 0; }
.qty-btn {
  width: 44px; height: 44px; /* alvos maiores no mobile */
  border-radius: var(--radius-10);
  border: 1px solid var(--border); background: var(--card); cursor: pointer;
  transition: transform var(--transition-fast);
}
.qty-btn:hover { transform: translateY(-1px); }
.primary-btn {
  min-height: 48px;
  background: linear-gradient(180deg, color-mix(in srgb, var(--primary) 30%, white) 0%, var(--primary) 100%);
  border: 1px solid color-mix(in srgb, var(--primary) 60%, black 10%);
  color: white;
  padding: 10px 16px; border-radius: var(--radius-12); cursor: pointer;
  box-shadow: var(--shadow-1);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast), filter var(--transition-fast);
}
.primary-btn:hover { transform: translateY(-1px); filter: brightness(1.03); box-shadow: var(--shadow-2); }

/* Observações (detalhe e carrinho) */
.note-field { margin: 12px 0 4px; display: flex; flex-direction: column; gap: 6px; }
.note-field label { font-size: var(--fs-5); color: var(--muted); }
.note-input, .note-edit {
  width: 100%; min-height: 48px; resize: vertical; padding: 10px 12px;
  border: 1px solid var(--border); border-radius: var(--radius-10);
  background: #fff; color: #1e1b17; font-size: 16px;
}
:root[data-theme="dark"] .note-input,
:root[data-theme="dark"] .note-edit {
  background: #181512; color: var(--text);
  border-color: var(--border);
}
.cart-note { grid-column: 1 / -1; margin-top: 8px; }

/* ===== Cart ===== */
.cart-list { display: flex; flex-direction: column; gap: 12px; margin: 16px 0; }
.cart-item {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius-12); padding: 12px;
  display: grid; grid-template-columns: 1fr auto; align-items: center;
  box-shadow: var(--shadow-1);
}
.cart-info h4 { margin: 0 0 4px; }
.cart-controls { display: inline-flex; align-items: center; gap: 8px; }
.cart-btn {
  width: 44px; height: 44px; border-radius: var(--radius-10);
  border: 1px solid var(--border); background: var(--card); cursor: pointer;
}
.cart-footer {
  border-top: 1px solid var(--border); padding-top: 12px;
  display: flex; justify-content: space-between; align-items: center;
  position: sticky; bottom: 0;
  padding-bottom: calc(var(--space-3) + var(--safe-bottom)); /* respeita safe area */
  background: linear-gradient(180deg, color-mix(in srgb, var(--card) 80%, transparent) 0%, var(--card) 100%);
}
.total-line { font-size: 18px; }
#cart-total { font-size: 20px; }

/* Picker de mesa (REQ 009) */
.table-picker {
  display: grid; grid-template-columns: auto 140px; align-items: end; gap: 10px; max-width: 360px;
}
.table-picker label { color: var(--text); font-weight: 600; }
#table-input {
  height: 44px; border: 1px solid var(--border); border-radius: var(--radius-10);
  padding: 0 10px; background: var(--card); color: var(--text);
  font-size: 16px; /* evita zoom iOS */
}
#table-input.table-error {
  border-color: var(--table-error);
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--table-error) 25%, transparent);
}
.table-hint { color: var(--muted); grid-column: 1 / -1; }

/* ===== Orders / Kitchen ===== */
.orders {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: var(--space-3);
}
.order-card {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius-12); padding: var(--space-3);
  box-shadow: var(--shadow-1);
  position: relative;
}
.order-card::before {
  content: ""; position: absolute; left: 0; top: 0; bottom: 0; width: 4px;
  background: linear-gradient(180deg, var(--primary), color-mix(in srgb, var(--primary) 30%, transparent));
  border-radius: var(--radius-12) 0 0 var(--radius-12);
}

/* ETA refinado */
.eta-line { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin-top: 8px; }
.eta-badge {
  background: color-mix(in srgb, var(--primary) 20%, var(--card));
  color: var(--text);
  padding: 4px 8px; border-radius: var(--radius-pill); font-size: 12px;
  border: 1px solid color-mix(in srgb, var(--primary) 35%, var(--border));
}
.eta-remaining { font-weight: 700; color: var(--eta-ok); }
.eta-remaining.eta-late { color: var(--eta-warn); }
.eta-time { color: var(--muted); font-size: 12px; }
.eta-progress {
  margin-top: 8px; width: 100%; height: 8px; background: var(--eta-bar); border-radius: var(--radius-pill); overflow: hidden;
}
.eta-progress .bar { height: 100%; width: 0%; background: var(--eta-bar-fill); transition: width .3s linear; }

/* ===== Pix ===== */
.pix-frame {
  max-width: 360px; margin: 0 auto; background: var(--card);
  border: 1px solid var(--border); border-radius: 18px; padding: 20px; text-align: center;
  box-shadow: var(--shadow-1);
}
.qr-area { display: flex; justify-content: center; margin: 14px 0; }
.fake-qr { border: 8px solid #111; border-radius: 10px; padding: 6px; background: #fff; }
.qr-grid { display: grid; grid-template-columns: repeat(10, 16px); grid-auto-rows: 16px; gap: 2px; }
.qr-grid span { background: #000; opacity: .95; }
.pix-sub { color: var(--muted); margin: 8px 0; }
.pix-logo { margin-top: 8px; font-weight: 700; letter-spacing: 1px; }

/* ===== Footer ===== */
.app-footer {
  padding: var(--space-3) var(--space-5) calc(var(--space-3) + var(--safe-bottom)) var(--space-5);
  text-align: center; color: var(--muted);
  border-top: 1px solid var(--border); margin-top: var(--space-5);
}

/* ===== Preferência de movimento ===== */
@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; }
}

/* ===== Ajustes para telas menores ===== */
@media (max-width: 880px) {
  .app-header { grid-template-columns: 1fr auto auto; gap: var(--space-2); }
  .table-status { display: none; } /* valor da mesa continua visível no Carrinho */
}
@media (hover: none) {
  /* Em dispositivos sem hover, reduza “efeitos de elevação” para evitar jitter */
  .card:hover, .nav-btn:hover, .primary-btn:hover, .qty-btn:hover, .add-btn:hover, .view-btn:hover, .icon-btn:hover {
    transform: none;
    box-shadow: var(--shadow-1);
  }
}
